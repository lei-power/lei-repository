@startuml
!include ../style.puml
autonumber  "0."

actor 农资库管员
participant "produce服务" as A

autonumber  "0."

农资库管员->A:删除农资出入库记录\r(已有接口修改，以下为新增逻辑)
activate A

A -> A: 入参校验
A -> A: <1> 校验目标删除的农机出入库记录是否存在\n<2>校验农资出库子任务态是否为**“待出库”**\n<3>校验用户信息是否合法



A -> A: <1>查询农事任务农资信息\n<2>查询该农资出库子任务的农资出入库记录信息

A -> A:判断农事任务农资已出库数量是否大于本次农事任务农资该出库的量，\n若是则操作'农资出入库记录表'删除该条记录

A -> A: 计算农事任务农机已出库数量字段,并更新'农事任务农机表'

A --> 农资库管员: 返回结果
deactivate A



@enduml