@startuml
!include ../style.puml
autonumber  "0."

actor 农资库管员
participant "produce服务" as A


农资库管员->A:出库
activate A
A -> A: 入参校验
A -> A: <1>校验农资出库子任务状态是否为**“待出库”**\n<2>校验用户信息是否合法


A -> A: <1>查询农事任务农资信息\n<2>查询该农资出库子任务的农资出入库记录列表\n<3> 校验该次农资出库入参中种类是否包含在农事任务农资信息中\n<3> 校验该次农资出库入参中种类数量农资库是否支持出库

A -> A: 领用农资，（复用已有接口逻辑）
A -> A: 组装农资出入记录数据,并插入'农资出入记录表'
A -> A: 计算农事任务农资已出库数量字段,并更新'农事任务农资表'


A --> 农资库管员: 返回结果
deactivate A

@enduml